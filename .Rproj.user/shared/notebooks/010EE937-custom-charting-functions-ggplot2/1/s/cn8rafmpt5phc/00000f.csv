"0","#| label: custom-theme-enhanced"
"0",""
"0","custom_theme <- function(plt, "
"0","                         palette = ""Set1"", "
"0","                         format_x_axis_as = NULL, "
"0","                         format_y_axis_as = NULL, "
"0","                         x_axis_scale = 1, "
"0","                         y_axis_scale = 1, "
"0","                         x_axis_text_size = 10, "
"0","                         y_axis_text_size = 10, "
"0","                         base_size = 11, "
"0","                         base_line_size = 1, "
"0","                         x_angle = 45){"
"0","  "
"0","  mappings <- names(unlist(plt$mapping))"
"0","  "
"0","  p <- plt + "
"0","    "
"0","    # Adjust overall font size"
"0","    theme_minimal(base_size = base_size, "
"0","                  base_line_size = base_line_size) + "
"0","    "
"0","    # Put legend at the bottom"
"0","    theme(legend.position = ""bottom"", "
"0","          axis.text.x = element_text(angle = x_angle)) + "
"0","    "
"0","    # Different colour palette"
"0","    {if(""colour"" %in% mappings) scale_color_brewer(palette = palette)}+"
"0","    "
"0","    {if(""fill"" %in% mappings) scale_fill_brewer(palette = palette)}+"
"0","    "
"0","    # Change some theme options"
"0","    theme(plot.background = element_rect(fill = ""#f7f7f7""), "
"0","          plot.subtitle = element_text(face = ""italic""), "
"0","          axis.title.x = element_text(face = ""bold"", "
"0","                                      size = x_axis_text_size), "
"0","          axis.title.y = element_text(face = ""bold"", "
"0","                                      size = y_axis_text_size)) + "
"0","    "
"0","    # Change x-axis formatting"
"0","    {if(!is.null(format_x_axis_as))"
"0","      switch(format_x_axis_as, "
"0","             ""date"" = scale_x_date(breaks = pretty_breaks(n = 12)), "
"0","             ""number"" = scale_x_continuous(labels = number_format(accuracy = 0.1, "
"0","                                                                  decimal.mark = "","", "
"0","                                                                  scale = x_axis_scale)), "
"0","             ""percent"" = scale_x_continuous(labels = percent))} + "
"0","    "
"0","    # Change y-axis formatting"
"0","    {if(!is.null(format_y_axis_as))"
"0","      "
"0","      switch(format_y_axis_as, "
"0","             ""date"" = scale_y_date(breaks = pretty_breaks(n = 12)), "
"0","             ""number"" = scale_y_continuous(labels = number_format(accuracy = 0.1, "
"0","                                                                  decimal.mark = "","", "
"0","                                                                  scale = y_axis_scale)), "
"0","             ""percent"" = scale_y_continuous(labels = percent))}"
"0","  "
"0","  # Capitalise all names"
"0","  vec <- lapply(p$labels, str_to_title)"
"0","  names(vec) <- names(p$labels)"
"0","  p$labels <- vec"
"0","  "
"0","  return(p)"
"0","}"
