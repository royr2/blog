"0","# Calculate daily returns for all stocks"
"0","# Formula: (Price_today / Price_yesterday) - 1"
"0","returns_df <- apply(prices_df[,-1], 2, function(vec){"
"0","  ret <- vec/lag(vec) - 1  # Simple returns calculation"
"0","  return(ret)"
"0","})"
"0",""
"0","# Convert to dataframe for easier manipulation"
"0","returns_df <- as.data.frame(returns_df)"
"0",""
"0","# Remove first row which contains NA values (no previous day to calculate return)"
"0","returns_df <- returns_df[-1,]  "
"0",""
"0","# Pre-compute average returns and covariance matrix for optimization"
"0","# These are key inputs to the mean-variance optimization"
"0","mean_returns <- sapply(returns_df, mean)  # Expected returns"
"0","cov_mat <- cov(returns_df)  # Risk (covariance) matrix"
