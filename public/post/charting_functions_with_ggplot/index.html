<!doctype html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name="hugo-theme" content="Axiom 0.8.0">



  <link rel="icon" type="image/png" sizes="32x32" href="/">
  <link rel="icon" type="image/x-icon" href="/">
  <link rel="apple-touch-icon" href="/">
  <link rel="canonical" href="https://rtichoke.netlify.app/post/charting_functions_with_ggplot/">
<link rel="preload" as="style" href="/bundle.css?v=1641649589" media="all">
<link rel="stylesheet" href="/bundle.css?v=1641649589" media="all">
<style>.cdata pre{background-color:#1f2937;color:#e5e7eb}.cdata :not(pre)>code{background-color:#f3f4f6;color:#7c3aed}.chroma .err{background-color:#991b1b;color:#fecaca}.chroma .hl{background-color:#374151}.chroma .ln{color:#9ca3af}.chroma .k,.chroma .kc,.chroma .kd,.chroma .kn,.chroma .kp,.chroma .kr{color:#60a5fa}.chroma .kt{color:#a78bfa}.chroma .na,.chroma .nb{color:#fbbf24}.chroma .nc{color:#f87171}.chroma .no{color:#34d399}.chroma .nd{color:#f87171}.chroma .ne{color:#f87171}.chroma .nf{color:#fbbf24}.chroma .nt{color:#f87171}.chroma .l{color:#a78bfa}.chroma .dl,.chroma .ld,.chroma .s,.chroma .s2,.chroma .sa,.chroma .sb,.chroma .sc,.chroma .sd{color:#34d399}.chroma .se{color:#9ca3af}.chroma .s1,.chroma .sh,.chroma .si,.chroma .sr,.chroma .ss,.chroma .sx{color:#34d399}.chroma .il,.chroma .m,.chroma .mb,.chroma .mf,.chroma .mh,.chroma .mi,.chroma .mo{color:#a78bfa}.chroma .o,.chroma .ow{color:#93c5fd}.chroma .c,.chroma .c1,.chroma .ch,.chroma .cm,.chroma .cp,.chroma .cpf,.chroma .cs,.chroma .p{color:#9ca3af}.chroma .ge{font-style:italic}.chroma .gs{font-weight:700}
</style>



<title>Custom charting functions using ggplot2 : R&#39;tichoke</title>

<meta property="og:title" content="Custom charting functions using ggplot2">
<meta property="og:site_name" content="R&#39;tichoke">
<meta property="og:url" content="https://rtichoke.netlify.app/post/charting_functions_with_ggplot/">
<link rel="image_src" href="https://rtichoke.netlify.app/">
<meta property="og:image" content="https://rtichoke.netlify.app/">
<meta property="og:image:width" content="">
<meta property="og:image:height" content="">
<meta property="og:type" content="article">
<meta property="og:locale" content="en_us">
<meta property="og:description" content="How to create a customised charting function using ggplot2">
<meta name="description" content="How to create a customised charting function using ggplot2">
<meta property="og:updated_time" content="2021-09-11T00:00:00Z">
<meta property="fb:app_id" content="">
<meta name="author" content="Riddhiman">
<meta property="article:author" content="https://linkedin.com/in/riddhimanr">
<meta property="article:published_time" content="2021-09-11T00:00:00Z">
<meta property="article:modified_time" content="2021-09-11T00:00:00Z">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Custom charting functions using ggplot2",
  "alternativeHeadline": "Data visualisation series (Post #1)",
  "url": "https://rtichoke.netlify.app/post/charting_functions_with_ggplot/",
  "image": "https://rtichoke.netlify.app/",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://rtichoke.netlify.app/post/charting_functions_with_ggplot/"
  },
  "description": "How to create a customised charting function using ggplot2",
  "author": {
    "@type": "Person",
    "name": "Riddhiman"
  },
  "publisher": {
    "@type": "Organization",
    "name": "R'tichoke",
    "logo": {
      "@type": "ImageObject",
      "url": "https://rtichoke.netlify.app/"
    }
  },
  "datePublished": "2021-09-11T00:00:00Z",
  "dateModified": "2021-09-11T00:00:00Z",
  "articleBody": "\u003cp\u003eWhile \u003ccode\u003eR\u003c/code\u003e has variety of options to choose from when it comes to 2D graphics and data visualisation, it is hard to beat \u003ccode\u003eggplot2\u003c/code\u003e in terms of features, functionality and overall visual quality. I wanted to share my take on how to use the package which is, to make customised charting functions for specific chart types using \u003ccode\u003eggplot2\u003c/code\u003e as the underlying visualisation engine.\u003c/p\u003e\n\u003ch2 id=\"libraries\"\u003eLibraries\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#75715e\"\u003e# Pacman is a package management tool \u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003einstall.packages\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pacman\u0026#34;\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#a6e22e\"\u003elibrary\u003c/span\u003e(pacman)\n\n\u003cspan style=\"color:#75715e\"\u003e# p_load automatically installs packages if needed\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003ep_load\u003c/span\u003e(dplyr, ggplot2, scales, stringr)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"sample-dataset\"\u003eSample dataset\u003c/h2\u003e\n\u003cp\u003eA summarised version of the COVID-19 Data Repository hosted by \u003ca href=\"https://github.com/CSSEGISandData/COVID-19\"\u003eJHU\u003c/a\u003e is available for download \u003ca href=\"https://github.com/royr2/blog/blob/main/download/covid_data.csv\"\u003ehere\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003edf \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eread.csv\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;covid_data.csv\u0026#34;\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSomething of interest could be the daily number of confirmed cases for the top five countries (by volume). Some amount of data prep is needed to get to these numbers.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#75715e\"\u003e# Get top 5 countries\u003c/span\u003e\ntop_countries \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e df \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003egroup_by\u003c/span\u003e(country) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003esummarise\u003c/span\u003e(count \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esum\u003c/span\u003e(deaths_daily)) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003etop_n\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  .$country\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#a6e22e\"\u003eprint\u003c/span\u003e(top_countries)\n\u003cspan style=\"color:#75715e\"\u003e## [1] \u0026#34;Brazil\u0026#34; \u0026#34;India\u0026#34;  \u0026#34;Mexico\u0026#34; \u0026#34;Peru\u0026#34;   \u0026#34;US\u0026#34;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#75715e\"\u003e# Create a data frame with the required information\u003c/span\u003e\n\u003cspan style=\"color:#75715e\"\u003e# Note that a centered 7 day moving average is used\u003c/span\u003e\nplotdf \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e df \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003emutate\u003c/span\u003e(date \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eas.Date\u003c/span\u003e(date)) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003efilter\u003c/span\u003e(country \u003cspan style=\"color:#f92672\"\u003e%in%\u003c/span\u003e top_countries, \n         date \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2020-05-01\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003egroup_by\u003c/span\u003e(country, date) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003esummarise\u003c/span\u003e(count \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esum\u003c/span\u003e(confirmed_daily)) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e\n  \u003cspan style=\"color:#a6e22e\"\u003earrange\u003c/span\u003e(country, date) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003egroup_by\u003c/span\u003e(country) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003emutate\u003c/span\u003e(MA \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e zoo\u003cspan style=\"color:#f92672\"\u003e::\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003erollapply\u003c/span\u003e(count, FUN \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e mean, width \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e, by \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, fill \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNA\u003c/span\u003e, align \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;center\u0026#34;\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"simple-example\"\u003eSimple example\u003c/h2\u003e\n\u003cp\u003eSay we needed a line chart visualising the data we just prepared. Note the use \u003ccode\u003eaes_string()\u003c/code\u003e instead of just \u003ccode\u003eaes()\u003c/code\u003e. This lets us supply arguments to \u003ccode\u003eggplot2\u003c/code\u003e as strings.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#75715e\"\u003e# Function definition.\u003c/span\u003e\nline_chart \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efunction\u003c/span\u003e(df, x, y, group_color \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e, line_width \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, line_type \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e){\n  \u003cspan style=\"color:#a6e22e\"\u003eggplot\u003c/span\u003e(df, \u003cspan style=\"color:#a6e22e\"\u003eaes_string\u003c/span\u003e(x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e x, y \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e y, color \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e group_color)) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \u003cspan style=\"color:#a6e22e\"\u003egeom_line\u003c/span\u003e(size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e line_width, linetype \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e line_type)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#75715e\"\u003e# Test run\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eline_chart\u003c/span\u003e(plotdf, x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;date\u0026#34;\u003c/span\u003e, y \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;MA\u0026#34;\u003c/span\u003e, group_color \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;country\u0026#34;\u003c/span\u003e, \n           line_type \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, line_width \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1.2\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"chart1-1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"customised-theme\"\u003eCustomised theme\u003c/h2\u003e\n\u003cp\u003eNow that we know how to encapsulate the call to \u003ccode\u003eggplot2\u003c/code\u003e in a more intuitive manner, we can create a customised theme for our charts. This is useful since this theme can be applied to any chart.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003ecustom_theme \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efunction\u003c/span\u003e(plt, base_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e11\u003c/span\u003e, base_line_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, palette \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Set1\u0026#34;\u003c/span\u003e){\n  \n  \u003cspan style=\"color:#75715e\"\u003e# Note the use of \u0026#34;+\u0026#34; and not \u0026#34;%\u0026gt;%\u0026#34;\u003c/span\u003e\n  plt \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \u003cspan style=\"color:#75715e\"\u003e# Adjust overall font size\u003c/span\u003e\n    \u003cspan style=\"color:#a6e22e\"\u003etheme_minimal\u003c/span\u003e(base_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e base_size, base_line_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e base_line_size) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Put legend at the bottom\u003c/span\u003e\n    \u003cspan style=\"color:#a6e22e\"\u003etheme\u003c/span\u003e(legend.position \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bottom\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Different colour scale\u003c/span\u003e\n    \u003cspan style=\"color:#a6e22e\"\u003escale_color_brewer\u003c/span\u003e(palette \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e palette)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#75715e\"\u003e# Test run\u003c/span\u003e\n\u003cspan style=\"color:#a6e22e\"\u003eline_chart\u003c/span\u003e(plotdf, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;date\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;MA\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;country\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecustom_theme\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"chart2-1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"adding-bells-and-whistles\"\u003eAdding bells and whistles\u003c/h2\u003e\n\u003cp\u003eNow that we have some of the basic components, we can add some additional features to our \u003ccode\u003eline_chart()\u003c/code\u003e function.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003eline_chart \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efunction\u003c/span\u003e(df, x, y, group_color \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e, \n                       line_width \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, line_type \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, \n                       xlab \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e, ylab \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e, \n                       title \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e, subtitle \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e, caption \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e){\n  \u003cspan style=\"color:#75715e\"\u003e# Base plot\u003c/span\u003e\n  \u003cspan style=\"color:#a6e22e\"\u003eggplot\u003c/span\u003e(df, \u003cspan style=\"color:#a6e22e\"\u003eaes_string\u003c/span\u003e(x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e x, y \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e y, color \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e group_color)) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Line chart \u003c/span\u003e\n    \u003cspan style=\"color:#a6e22e\"\u003egeom_line\u003c/span\u003e(size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e line_width, linetype \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e line_type) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Titles and subtitles\u003c/span\u003e\n    \u003cspan style=\"color:#a6e22e\"\u003elabs\u003c/span\u003e(x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e xlab, y \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e ylab, title \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e title, subtitle \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e subtitle, caption \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e caption)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe\u0026rsquo;ll also tinker with our \u003ccode\u003ecustom_theme()\u003c/code\u003e function.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003ecustom_theme \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efunction\u003c/span\u003e(plt, \n                         palette \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Set1\u0026#34;\u003c/span\u003e, \n                         format_x_axis_as \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e, format_y_axis_as \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e, \n                         x_axis_scale \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, y_axis_scale \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, \n                         x_axis_text_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e, y_axis_text_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e, \n                         base_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e11\u003c/span\u003e, base_line_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e){\n  \n  mappings \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enames\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eunlist\u003c/span\u003e(plt\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003emapping))\n  \n  p \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e plt \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Adjust overall font size\u003c/span\u003e\n    \u003cspan style=\"color:#a6e22e\"\u003etheme_minimal\u003c/span\u003e(base_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e base_size, base_line_size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e base_line_size) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Put legend at the bottom\u003c/span\u003e\n    \u003cspan style=\"color:#a6e22e\"\u003etheme\u003c/span\u003e(legend.position \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bottom\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Different colour palette\u003c/span\u003e\n    {\u003cspan style=\"color:#a6e22e\"\u003eif\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;colour\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%in%\u003c/span\u003e mappings) \u003cspan style=\"color:#a6e22e\"\u003escale_color_brewer\u003c/span\u003e(palette \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e palette)}\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\n    \n    {\u003cspan style=\"color:#a6e22e\"\u003eif\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fill\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%in%\u003c/span\u003e mappings) \u003cspan style=\"color:#a6e22e\"\u003escale_fill_brewer\u003c/span\u003e(palette \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e palette)}\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\n    \n    \u003cspan style=\"color:#75715e\"\u003e# Change some theme options\u003c/span\u003e\n    \u003cspan style=\"color:#a6e22e\"\u003etheme\u003c/span\u003e(plot.background \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eelement_rect\u003c/span\u003e(fill \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;#f7f7f7\u0026#34;\u003c/span\u003e), \n          plot.subtitle \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eelement_text\u003c/span\u003e(face \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;italic\u0026#34;\u003c/span\u003e), \n          axis.title.x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eelement_text\u003c/span\u003e(face \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bold\u0026#34;\u003c/span\u003e, \n                                      size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e x_axis_text_size), \n          axis.title.y \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eelement_text\u003c/span\u003e(face \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bold\u0026#34;\u003c/span\u003e, \n                                      size \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e y_axis_text_size)) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Change x-axis formatting\u003c/span\u003e\n    {\u003cspan style=\"color:#a6e22e\"\u003eif\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eis.null\u003c/span\u003e(format_x_axis_as))\n      \u003cspan style=\"color:#a6e22e\"\u003eswitch\u003c/span\u003e(format_x_axis_as, \n             \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;date\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003escale_x_date\u003c/span\u003e(breaks \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003epretty_breaks\u003c/span\u003e(n \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e)), \n             \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;number\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003escale_x_continuous\u003c/span\u003e(labels \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enumber_format\u003c/span\u003e(accuracy \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e, \n                                                                  decimal.mark \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e, \n                                                                  scale \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e x_axis_scale)), \n             \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;percent\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003escale_x_continuous\u003c/span\u003e(labels \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e percent))} \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n    \n    \u003cspan style=\"color:#75715e\"\u003e# Change y-axis formatting\u003c/span\u003e\n    {\u003cspan style=\"color:#a6e22e\"\u003eif\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eis.null\u003c/span\u003e(format_y_axis_as))\n      \n      \u003cspan style=\"color:#a6e22e\"\u003eswitch\u003c/span\u003e(format_y_axis_as, \n             \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;date\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003escale_y_date\u003c/span\u003e(breaks \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003epretty_breaks\u003c/span\u003e(n \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e)), \n             \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;number\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003escale_y_continuous\u003c/span\u003e(labels \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enumber_format\u003c/span\u003e(accuracy \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.1\u003c/span\u003e, \n                                                                  decimal.mark \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e, \n                                                                  scale \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e y_axis_scale)), \n             \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;percent\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003escale_y_continuous\u003c/span\u003e(labels \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e percent))}\n  \n  \u003cspan style=\"color:#75715e\"\u003e# Capitalise all names\u003c/span\u003e\n  vec \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elapply\u003c/span\u003e(p\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003elabels, str_to_title)\n  \u003cspan style=\"color:#a6e22e\"\u003enames\u003c/span\u003e(vec) \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enames\u003c/span\u003e(p\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003elabels)\n  p\u003cspan style=\"color:#f92672\"\u003e$\u003c/span\u003elabels \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e vec\n  \n  \u003cspan style=\"color:#a6e22e\"\u003ereturn\u003c/span\u003e(p)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow let\u0026rsquo;s see how it all comes together.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"color:#a6e22e\"\u003eline_chart\u003c/span\u003e(plotdf,\n           x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;date\u0026#34;\u003c/span\u003e, \n           y \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;MA\u0026#34;\u003c/span\u003e, \n           group_color \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;country\u0026#34;\u003c/span\u003e, \n           xlab \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Date\u0026#34;\u003c/span\u003e, \n           ylab \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Moving Avg. (in \u0026#39;000)\u0026#34;\u003c/span\u003e, \n           title \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Daily COVID19 Case Load\u0026#34;\u003c/span\u003e, \n           subtitle \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Top 5 countries by volume\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \n  \u003cspan style=\"color:#a6e22e\"\u003ecustom_theme\u003c/span\u003e(format_x_axis_as \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;date\u0026#34;\u003c/span\u003e, \n               format_y_axis_as \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;number\u0026#34;\u003c/span\u003e, \n               y_axis_scale \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.001\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"chart3-1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"bar-chart-example\"\u003eBar chart example\u003c/h2\u003e\n\u003cp\u003eThe good thing about the \u003ccode\u003ecustom_theme()\u003c/code\u003e function is that it can be applied to any \u003ccode\u003eggplot2\u003c/code\u003e object.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003ep \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e plotdf \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e  \n  \u003cspan style=\"color:#a6e22e\"\u003emutate\u003c/span\u003e(month \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eformat\u003c/span\u003e(date, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%m-%b\u0026#34;\u003c/span\u003e)) \u003cspan style=\"color:#f92672\"\u003e%\u0026gt;%\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003eggplot\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eaes\u003c/span\u003e(x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e month, y \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e MA, fill \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e country)) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003egeom_col\u003c/span\u003e(position \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dodge\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n  \u003cspan style=\"color:#a6e22e\"\u003elabs\u003c/span\u003e(title \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Monthly COVID19 Case load trend\u0026#34;\u003c/span\u003e, \n       subtitle \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Top 5 countries\u0026#34;\u003c/span\u003e, \n       x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Month\u0026#34;\u003c/span\u003e, \n       y \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Moving Average (\u0026#39;000)\u0026#34;\u003c/span\u003e)\n\n\u003cspan style=\"color:#a6e22e\"\u003ecustom_theme\u003c/span\u003e(p, palette \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Set1\u0026#34;\u003c/span\u003e, format_y_axis_as \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;number\u0026#34;\u003c/span\u003e, y_axis_scale \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.001\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"chart4-1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"parting-notes\"\u003eParting notes\u003c/h2\u003e\n\u003cp\u003eIt is worth noting that building customised charting functions using \u003ccode\u003eggplot2\u003c/code\u003e is most useful when you need to create the same type of chart(s) again and again. When doing any kind of exploratory work, using \u003ccode\u003eggplot2\u003c/code\u003e directly is easier and more useful since you can build all kinds of charts (or layer charts of different types) within the same pipeline.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eThoughts? Comments? Helpful? Not helpful? Like to see anything else added in here? Let me know!\u003c/em\u003e\u003c/p\u003e"
}
</script>

<link rel="preload" as="script" href="/bundle.js?v=1641649589">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://stats.g.doubleclick.net">
<link rel="preconnect" href="https://www.googleadservices.com">
<link rel="preload" as="script" href="https://www.googletagmanager.com/gtag/js?id=UA-57026003-1">
<script src="https://www.googletagmanager.com/gtag/js?id=UA-57026003-1"></script>
<script>
  window.dataLayer=window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js',new Date());
  gtag('config','UA-57026003-1');
</script>

</head>
<body>

  <header id="nav" class="header">
  <div class="ax-l-i max-w-6xl">
    <div class="ax-logo">
      <a class="block" href="/" title="R&#39;tichoke"><span class="font-semibold text-raven-900">R'tichoke</span></a>
    </div>
    <div class="ax-user">
      <a class="p-2 w-8 h-8 block text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" target="_blank" rel="noopener nofollow" href="https://www.google.com/search?q=site:https://rtichoke.netlify.app/" title="Search">
        <svg class="fill-current" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M2.67 12.804c0-5.6 4.544-10.134 10.133-10.134s10.134 4.544 10.134 10.134-4.544 10.133-10.134 10.133S2.67 18.393 2.67 12.804zm28.943 16.923l-8.868-8.868c4.287-5.3 3.68-13.012-1.378-17.57S8.564-1.066 3.75 3.75s-5.017 12.558-.46 17.618 12.28 5.665 17.57 1.378l8.868 8.868a1.33 1.33 0 0 0 2.231-.597c.123-.46-.008-.952-.345-1.29h0z"/></svg>

      </a>
      <a class="p-2 block text-base leading-none text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" href="/post/">
        Posts
      </a>
      <a class="p-2 block text-base leading-none text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" href="/about/">
        About
      </a>
      <a class="p-2 block text-base leading-none text-raven-500 hover:text-gray-800 focus:text-gray-800 focus:outline-none" href="/rbloggers/">
        R-Bloggers
      </a>
    </div>
  </div>

  
  
</header>


  <main>
<div class="default-single">
  <div class="ax-title ax-l-o">
    <div class="ax-l-i max-w-4xl">
      <h1 class="post-title font-content-title font-normal leading-tight tracking-default text-40">Custom charting functions using ggplot2</h1>
      <p class="post-subtitle font-content-sans font-light text-xl text-raven-500 mt-3">Data visualisation series (Post #1)</p>

      <div class="ax-meta flex items-center mt-5">
        <div class="flex-grow min-w-0">
          <div class="flex items-center">
  
  <div class="flex-shrink-0">
    <img
    class="w-12 h-12 sm:w-14 sm:h-14 object-cover p-3px rounded-full border border-blue-300"
    src="data:image/svg&#43;xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzIgMzIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI&#43;PHBhdGggZmlsbD0iI2VjZWZmMSIgZD0iTTAgMGgzMnYzMkgweiIvPjxwYXRoIGZpbGw9IiM0NTVhNjQiIGQ9Ik0yOS4zMDUgMjQuNDA3Yy0uNzk1LS42My0xLjc2NS0xLjA4LTIuODE2LTEuM0wyMS40NzYgMjIuMWExLjEzIDEuMTMgMCAwIDEtLjkwNS0xLjEydi0xLjE1Yy4zMjItLjQ1My42MjYtMS4wNTQuOTQ0LTEuNjgyLjI0Ny0uNDg3LjYyLTEuMjIuODA1LTEuNCAxLjAxNS0xLjAyIDEuOTk1LTIuMTY1IDIuMy0zLjY0LjI4My0xLjM4NS4wMDUtMi4xMTItLjMyMi0yLjY5NyAwLTEuNDYtLjA0Ni0zLjI5LS4zOS00LjYyLS4wNC0xLjgtLjM2OC0yLjgxNC0xLjE5LTMuNy0uNTgtLjYzLTEuNDM1LS43NzUtMi4xMjMtLjg5LS4yNy0uMDQ2LS42NDItLjEtLjc4LS4xODNDMTguNTk0LjM0NyAxNy40LjAyNSAxNS45NTIgMGMtMyAuMTIzLTYuNzEgMi4wNC03Ljk1IDUuNDU0LS4zODQgMS4wNC0uMzQ1IDIuNzQ3LS4zMTMgNC4xMmwtLjAzLjgyNWMtLjI5NS41NzYtLjU4NSAxLjMwNy0uMyAyLjY5Ny4zMDIgMS40OCAxLjI4MiAyLjYyNiAyLjMxNSAzLjY2LjE3LjE3NC41NS45MTQuODAyIDEuNDAzbC45NSAxLjY3NXYxLjE1YzAgLjU0Ni0uMzgyIDEuMDE3LS45IDEuMTJMNS41IDIzLjExYy0xLjA0NS4yMjItMi4wMTQuNjctMi44MDcgMS4yOThhMS4xNSAxLjE1IDAgMCAwLS40MjcuODA1IDEuMTQgMS4xNCAwIDAgMCAuMjkzLjg1OUM1Ljk3NSAyOS44MzggMTAuODczIDMyIDE2IDMyczEwLjAyNy0yLjE2IDEzLjQ0LTUuOTNhMS4xNCAxLjE0IDAgMCAwLS4xMzUtMS42NjR6Ii8&#43;PC9zdmc&#43;Cg=="
    alt="">
	</div>
    
  <div class="flex-shrink-0 ml-2 leading-tight font-content-sans">
    <a class="block text-sm text-raven-800 hover:text-raven-900 hover:underline focus:underline" target="_blank" rel="noopener nofollow" title="Riddhiman" href="https://linkedin.com/in/riddhimanr">Riddhiman</a>
    <time class="text-sm text-raven-500" datetime="2021-09-11T00:00:00Z">Sep 11, 2021</time>
  </div>
</div>

        </div>
        <div>
          

<div class="flex items-center">
    <a class="flex-shrink-0 block text-raven-800 hover:text-raven-900" target="_blank" rel="noopener nofollow" title="Share on Twitter" href="https://twitter.com/intent/tweet?text=Custom%20charting%20functions%20using%20ggplot2%20by%20%40%25%21s%28%3cnil%3e%29%20https%3a%2f%2frtichoke.netlify.app%2fpost%2fcharting_functions_with_ggplot%2f"><svg class="w-6 h-6 fill-current" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M32 6.078c-1.2.522-2.458.868-3.78 1.036 1.36-.812 2.398-2.088 2.886-3.626a13.11 13.11 0 0 1-4.16 1.588C25.742 3.794 24.026 3 22.154 3a6.56 6.56 0 0 0-6.556 6.562c0 .52.044 1.02.152 1.496-5.454-.266-10.28-2.88-13.522-6.862-.566.982-.898 2.106-.898 3.316a6.57 6.57 0 0 0 2.914 5.452 6.48 6.48 0 0 1-2.964-.808v.072c0 3.188 2.274 5.836 5.256 6.446-.534.146-1.116.216-1.72.216-.42 0-.844-.024-1.242-.112.85 2.598 3.262 4.508 6.13 4.57a13.18 13.18 0 0 1-8.134 2.798c-.538 0-1.054-.024-1.57-.1C2.906 27.93 6.35 29 10.064 29c12.072 0 18.672-10 18.672-18.668 0-.3-.01-.57-.024-.848C30.014 8.56 31.108 7.406 32 6.078z"/></svg>
</a>
    <a class="ml-3 flex-shrink-0 block text-raven-800 hover:text-raven-900" target="_blank" rel="noopener nofollow" title="Share on Facebook" href="https://www.facebook.com/dialog/share?app_id=&display=page&href=https%3a%2f%2frtichoke.netlify.app%2fpost%2fcharting_functions_with_ggplot%2f"><svg class="w-6 h-6 fill-current" viewBox="-7 -3.5 39 39" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M30.234 0H1.765C.8.001 0 .79 0 1.766v28.47C.001 31.2.79 32 1.766 32h15.328V19.625h-4.156V14.78h4.156v-3.564c0-4.134 2.523-6.384 6.21-6.384 1.766 0 3.284.13 3.726.2v4.32h-2.543c-2.006 0-2.394.953-2.394 2.352v3.085h4.797l-.625 4.844h-4.172V32h8.14C31.21 32 32 31.2 32 30.234V1.765C32 .8 31.21 0 30.234 0z"/></svg>
</a>
  
</div>
        </div>
      </div>
    </div>
  </div><div class="ax-content ax-l-o">
    <div class="ax-l-i max-w-4xl">
      <article class="cdata">
<p>While <code>R</code> has variety of options to choose from when it comes to 2D graphics and data visualisation, it is hard to beat <code>ggplot2</code> in terms of features, functionality and overall visual quality. I wanted to share my take on how to use the package which is, to make customised charting functions for specific chart types using <code>ggplot2</code> as the underlying visualisation engine.</p>
<h2 id="libraries">Libraries</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Pacman is a package management tool </span>
<span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;pacman&#34;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(pacman)

<span style="color:#75715e"># p_load automatically installs packages if needed</span>
<span style="color:#a6e22e">p_load</span>(dplyr, ggplot2, scales, stringr)
</code></pre></div><h2 id="sample-dataset">Sample dataset</h2>
<p>A summarised version of the COVID-19 Data Repository hosted by <a href="https://github.com/CSSEGISandData/COVID-19">JHU</a> is available for download <a href="https://github.com/royr2/blog/blob/main/download/covid_data.csv">here</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;covid_data.csv&#34;</span>)
</code></pre></div><p>Something of interest could be the daily number of confirmed cases for the top five countries (by volume). Some amount of data prep is needed to get to these numbers.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Get top 5 countries</span>
top_countries <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(country) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">summarise</span>(count <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(deaths_daily)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">top_n</span>(<span style="color:#ae81ff">5</span>) <span style="color:#f92672">%&gt;%</span> 
  .$country
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">print</span>(top_countries)
<span style="color:#75715e">## [1] &#34;Brazil&#34; &#34;India&#34;  &#34;Mexico&#34; &#34;Peru&#34;   &#34;US&#34;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Create a data frame with the required information</span>
<span style="color:#75715e"># Note that a centered 7 day moving average is used</span>
plotdf <span style="color:#f92672">&lt;-</span> df <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(date <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.Date</span>(date)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(country <span style="color:#f92672">%in%</span> top_countries, 
         date <span style="color:#f92672">&gt;=</span> <span style="color:#e6db74">&#34;2020-05-01&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(country, date) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">summarise</span>(count <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(confirmed_daily)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">arrange</span>(country, date) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(country) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(MA <span style="color:#f92672">=</span> zoo<span style="color:#f92672">::</span><span style="color:#a6e22e">rollapply</span>(count, FUN <span style="color:#f92672">=</span> mean, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">7</span>, by <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, fill <span style="color:#f92672">=</span> <span style="color:#66d9ef">NA</span>, align <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;center&#34;</span>))
</code></pre></div><h2 id="simple-example">Simple example</h2>
<p>Say we needed a line chart visualising the data we just prepared. Note the use <code>aes_string()</code> instead of just <code>aes()</code>. This lets us supply arguments to <code>ggplot2</code> as strings.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Function definition.</span>
line_chart <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(df, x, y, group_color <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, line_width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, line_type <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>){
  <span style="color:#a6e22e">ggplot</span>(df, <span style="color:#a6e22e">aes_string</span>(x <span style="color:#f92672">=</span> x, y <span style="color:#f92672">=</span> y, color <span style="color:#f92672">=</span> group_color)) <span style="color:#f92672">+</span> 
    <span style="color:#a6e22e">geom_line</span>(size <span style="color:#f92672">=</span> line_width, linetype <span style="color:#f92672">=</span> line_type)
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Test run</span>
<span style="color:#a6e22e">line_chart</span>(plotdf, x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;date&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;MA&#34;</span>, group_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;country&#34;</span>, 
           line_type <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, line_width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.2</span>)
</code></pre></div><p><img src="chart1-1.png" alt=""></p>
<h2 id="customised-theme">Customised theme</h2>
<p>Now that we know how to encapsulate the call to <code>ggplot2</code> in a more intuitive manner, we can create a customised theme for our charts. This is useful since this theme can be applied to any chart.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">custom_theme <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(plt, base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>, base_line_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>){
  
  <span style="color:#75715e"># Note the use of &#34;+&#34; and not &#34;%&gt;%&#34;</span>
  plt <span style="color:#f92672">+</span> 
    <span style="color:#75715e"># Adjust overall font size</span>
    <span style="color:#a6e22e">theme_minimal</span>(base_size <span style="color:#f92672">=</span> base_size, base_line_size <span style="color:#f92672">=</span> base_line_size) <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Put legend at the bottom</span>
    <span style="color:#a6e22e">theme</span>(legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Different colour scale</span>
    <span style="color:#a6e22e">scale_color_brewer</span>(palette <span style="color:#f92672">=</span> palette)
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Test run</span>
<span style="color:#a6e22e">line_chart</span>(plotdf, <span style="color:#e6db74">&#34;date&#34;</span>, <span style="color:#e6db74">&#34;MA&#34;</span>, <span style="color:#e6db74">&#34;country&#34;</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">custom_theme</span>()
</code></pre></div><p><img src="chart2-1.png" alt=""></p>
<h2 id="adding-bells-and-whistles">Adding bells and whistles</h2>
<p>Now that we have some of the basic components, we can add some additional features to our <code>line_chart()</code> function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">line_chart <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(df, x, y, group_color <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, 
                       line_width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, line_type <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, 
                       xlab <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, ylab <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, 
                       title <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, subtitle <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, caption <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>){
  <span style="color:#75715e"># Base plot</span>
  <span style="color:#a6e22e">ggplot</span>(df, <span style="color:#a6e22e">aes_string</span>(x <span style="color:#f92672">=</span> x, y <span style="color:#f92672">=</span> y, color <span style="color:#f92672">=</span> group_color)) <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Line chart </span>
    <span style="color:#a6e22e">geom_line</span>(size <span style="color:#f92672">=</span> line_width, linetype <span style="color:#f92672">=</span> line_type) <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Titles and subtitles</span>
    <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> xlab, y <span style="color:#f92672">=</span> ylab, title <span style="color:#f92672">=</span> title, subtitle <span style="color:#f92672">=</span> subtitle, caption <span style="color:#f92672">=</span> caption)
}
</code></pre></div><p>We&rsquo;ll also tinker with our <code>custom_theme()</code> function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">custom_theme <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(plt, 
                         palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>, 
                         format_x_axis_as <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, format_y_axis_as <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, 
                         x_axis_scale <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, y_axis_scale <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, 
                         x_axis_text_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, y_axis_text_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, 
                         base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>, base_line_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>){
  
  mappings <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">names</span>(<span style="color:#a6e22e">unlist</span>(plt<span style="color:#f92672">$</span>mapping))
  
  p <span style="color:#f92672">&lt;-</span> plt <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Adjust overall font size</span>
    <span style="color:#a6e22e">theme_minimal</span>(base_size <span style="color:#f92672">=</span> base_size, base_line_size <span style="color:#f92672">=</span> base_line_size) <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Put legend at the bottom</span>
    <span style="color:#a6e22e">theme</span>(legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Different colour palette</span>
    {<span style="color:#a6e22e">if</span>(<span style="color:#e6db74">&#34;colour&#34;</span> <span style="color:#f92672">%in%</span> mappings) <span style="color:#a6e22e">scale_color_brewer</span>(palette <span style="color:#f92672">=</span> palette)}<span style="color:#f92672">+</span>
    
    {<span style="color:#a6e22e">if</span>(<span style="color:#e6db74">&#34;fill&#34;</span> <span style="color:#f92672">%in%</span> mappings) <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> palette)}<span style="color:#f92672">+</span>
    
    <span style="color:#75715e"># Change some theme options</span>
    <span style="color:#a6e22e">theme</span>(plot.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#f7f7f7&#34;</span>), 
          plot.subtitle <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;italic&#34;</span>), 
          axis.title.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>, 
                                      size <span style="color:#f92672">=</span> x_axis_text_size), 
          axis.title.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>, 
                                      size <span style="color:#f92672">=</span> y_axis_text_size)) <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Change x-axis formatting</span>
    {<span style="color:#a6e22e">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.null</span>(format_x_axis_as))
      <span style="color:#a6e22e">switch</span>(format_x_axis_as, 
             <span style="color:#e6db74">&#34;date&#34;</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale_x_date</span>(breaks <span style="color:#f92672">=</span> <span style="color:#a6e22e">pretty_breaks</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>)), 
             <span style="color:#e6db74">&#34;number&#34;</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale_x_continuous</span>(labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">number_format</span>(accuracy <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>, 
                                                                  decimal.mark <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;,&#34;</span>, 
                                                                  scale <span style="color:#f92672">=</span> x_axis_scale)), 
             <span style="color:#e6db74">&#34;percent&#34;</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale_x_continuous</span>(labels <span style="color:#f92672">=</span> percent))} <span style="color:#f92672">+</span> 
    
    <span style="color:#75715e"># Change y-axis formatting</span>
    {<span style="color:#a6e22e">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.null</span>(format_y_axis_as))
      
      <span style="color:#a6e22e">switch</span>(format_y_axis_as, 
             <span style="color:#e6db74">&#34;date&#34;</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale_y_date</span>(breaks <span style="color:#f92672">=</span> <span style="color:#a6e22e">pretty_breaks</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>)), 
             <span style="color:#e6db74">&#34;number&#34;</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale_y_continuous</span>(labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">number_format</span>(accuracy <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>, 
                                                                  decimal.mark <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;,&#34;</span>, 
                                                                  scale <span style="color:#f92672">=</span> y_axis_scale)), 
             <span style="color:#e6db74">&#34;percent&#34;</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale_y_continuous</span>(labels <span style="color:#f92672">=</span> percent))}
  
  <span style="color:#75715e"># Capitalise all names</span>
  vec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lapply</span>(p<span style="color:#f92672">$</span>labels, str_to_title)
  <span style="color:#a6e22e">names</span>(vec) <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">names</span>(p<span style="color:#f92672">$</span>labels)
  p<span style="color:#f92672">$</span>labels <span style="color:#f92672">&lt;-</span> vec
  
  <span style="color:#a6e22e">return</span>(p)
}
</code></pre></div><p>Now let&rsquo;s see how it all comes together.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">line_chart</span>(plotdf,
           x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;date&#34;</span>, 
           y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;MA&#34;</span>, 
           group_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;country&#34;</span>, 
           xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Date&#34;</span>, 
           ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Moving Avg. (in &#39;000)&#34;</span>, 
           title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Daily COVID19 Case Load&#34;</span>, 
           subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Top 5 countries by volume&#34;</span>)<span style="color:#f92672">%&gt;%</span> 
  
  <span style="color:#a6e22e">custom_theme</span>(format_x_axis_as <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;date&#34;</span>, 
               format_y_axis_as <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;number&#34;</span>, 
               y_axis_scale <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.001</span>)
</code></pre></div><p><img src="chart3-1.png" alt=""></p>
<h2 id="bar-chart-example">Bar chart example</h2>
<p>The good thing about the <code>custom_theme()</code> function is that it can be applied to any <code>ggplot2</code> object.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p <span style="color:#f92672">&lt;-</span> plotdf <span style="color:#f92672">%&gt;%</span>  
  <span style="color:#a6e22e">mutate</span>(month <span style="color:#f92672">=</span> <span style="color:#a6e22e">format</span>(date, <span style="color:#e6db74">&#34;%m-%b&#34;</span>)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> month, y <span style="color:#f92672">=</span> MA, fill <span style="color:#f92672">=</span> country)) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">geom_col</span>(position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dodge&#34;</span>) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Monthly COVID19 Case load trend&#34;</span>, 
       subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Top 5 countries&#34;</span>, 
       x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Month&#34;</span>, 
       y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Moving Average (&#39;000)&#34;</span>)

<span style="color:#a6e22e">custom_theme</span>(p, palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Set1&#34;</span>, format_y_axis_as <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;number&#34;</span>, y_axis_scale <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.001</span>)
</code></pre></div><p><img src="chart4-1.png" alt=""></p>
<h2 id="parting-notes">Parting notes</h2>
<p>It is worth noting that building customised charting functions using <code>ggplot2</code> is most useful when you need to create the same type of chart(s) again and again. When doing any kind of exploratory work, using <code>ggplot2</code> directly is easier and more useful since you can build all kinds of charts (or layer charts of different types) within the same pipeline.</p>
<p><em>Thoughts? Comments? Helpful? Not helpful? Like to see anything else added in here? Let me know!</em></p>

      </article>
      

      
<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
  this.page.url = "https://rtichoke.netlify.app/post/charting_functions_with_ggplot/";
  this.page.identifier = "b90c61ec950972953ffa18e446ac9540";
  this.page.title = "Custom charting functions using ggplot2";
};

(function() {
  window.setTimeout(function() {
    var d = document;
    var s = d.createElement('script');
    s.src = 'https://rtichoke.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    s.setAttribute("defer", "");
    d.body.appendChild(s);
  }, 2500);
})();
</script>

    </div>
  </div>
</div>

  </main>
  <footer class="footer">
  <div class="ax-l-i max-w-6xl">
    <nav class="flex items-center justify-center">
    </nav>
    <div class="footer-social flex items-center justify-center mt-4">
      <a class="block mx-3 w-6 h-6 text-raven-700 hover:text-raven-900" target="_blank" rel="noopener nofollow" title="Twitter" href="https://twitter.com/r0yr2"><svg class="fill-current" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M32 6.078c-1.2.522-2.458.868-3.78 1.036 1.36-.812 2.398-2.088 2.886-3.626a13.11 13.11 0 0 1-4.16 1.588C25.742 3.794 24.026 3 22.154 3a6.56 6.56 0 0 0-6.556 6.562c0 .52.044 1.02.152 1.496-5.454-.266-10.28-2.88-13.522-6.862-.566.982-.898 2.106-.898 3.316a6.57 6.57 0 0 0 2.914 5.452 6.48 6.48 0 0 1-2.964-.808v.072c0 3.188 2.274 5.836 5.256 6.446-.534.146-1.116.216-1.72.216-.42 0-.844-.024-1.242-.112.85 2.598 3.262 4.508 6.13 4.57a13.18 13.18 0 0 1-8.134 2.798c-.538 0-1.054-.024-1.57-.1C2.906 27.93 6.35 29 10.064 29c12.072 0 18.672-10 18.672-18.668 0-.3-.01-.57-.024-.848C30.014 8.56 31.108 7.406 32 6.078z"/></svg></a>
      <a class="block mx-3 w-6 h-6 text-raven-700 hover:text-raven-900" target="_blank" rel="noopener nofollow" title="GitHub" href="https://github.com/royr2"><svg class="fill-current" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M15.998 0C7.164 0 0 7.35 0 16.417 0 23.67 4.584 29.82 10.944 31.994c.8.15 1.092-.356 1.092-.79l-.022-2.792c-4.45.99-5.4-2.202-5.4-2.202-.726-1.896-1.776-2.4-1.776-2.4-1.454-1.018.108-.998.108-.998 1.606.117 2.45 1.693 2.45 1.693 1.428 2.507 3.746 1.784 4.658 1.363.144-1.06.558-1.784 1.016-2.195-3.552-.415-7.288-1.823-7.288-8.113 0-1.792.624-3.258 1.648-4.406-.166-.415-.714-2.085.156-4.344 0 0 1.344-.44 4.4 1.683 1.276-.364 2.644-.546 4.006-.552a14.98 14.98 0 0 1 4.006.554C23.062 6.37 24.404 6.8 24.404 6.8c.872 2.26.324 3.93.16 4.344 1.026 1.148 1.644 2.614 1.644 4.406 0 6.306-3.74 7.694-7.304 8.1.574.507 1.086 1.51 1.086 3.04l-.02 4.503c0 .44.288.95 1.1.788C27.42 29.817 32 23.667 32 16.417 32 7.35 24.836 0 15.998 0z"/></svg></a>
      <a class="block mx-3 w-6 h-6 text-raven-700 hover:text-raven-900" target="_blank" rel="noopener nofollow" title="LinkedIn" href="https://www.linkedin.com/in/riddhimanr"><svg class="fill-current" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M29.692 0H2.308A2.31 2.31 0 0 0 0 2.308v27.384A2.31 2.31 0 0 0 2.308 32h27.384A2.31 2.31 0 0 0 32 29.692V2.308A2.31 2.31 0 0 0 29.692 0zM11.35 24.188H7.454V12.464h3.897v11.723zM9.402 10.863h-.025c-1.308 0-2.153-.9-2.153-2.025 0-1.15.872-2.026 2.205-2.026s2.153.875 2.18 2.026c0 1.125-.846 2.025-2.205 2.025zm16 13.324h-3.896v-6.272c0-1.576-.564-2.65-1.974-2.65-1.076 0-1.717.725-2 1.425-.103.25-.128.6-.128.95v6.547h-3.896V12.464h3.896v1.66c.518-.8 1.444-1.935 3.512-1.935 2.564 0 4.486 1.676 4.486 5.276v6.722z"/></svg></a>
    </div>

    <div class="footer-copyright text-sm text-center text-gray-400 mt-4">
      &#169; 2021-2022 R&#39;tichoke
    </div>
    <div class="text-sm sm:text-xs text-center text-gray-400 mt-2">
      Powered by <a href="https://www.axiomtheme.com/?utm_source=theme-footer&utm_medium=website&utm_campaign=referral">Axiom</a>
    </div>
  </div>
</footer>

<script src="/bundle.js?v=1641649589"></script>


</body>
</html>
